<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Dashboard</title>
  <link rel="stylesheet" href="css.css">
</head>

<body>
  <div class="container">
    <div class="top-bar">
      <button id="darkModeToggle">Dark Mode</button>
      <div class="search-box">
        <input id="cityInput" type="text" placeholder="Search for your preferred city...">
      </div>
      <button id="getWeatherBtn">Get Weather</button>
    </div>

    <div class="section">
      <div class="card center card_time">
        <div id="cityName" class="title">City</div>
        <div id="currentTime" class="time">--:--</div>
        <div id="currentDate" class="weather-info">Day, Date</div>
      </div>
      <div class="card card_info">
        <div id="tempInfo" class="weather-info"></div>
        <div id="weatherIcon" class="weather-icon"></div>
        <div id="sunrise" class="weather-info"></div>
        <div id="sunset" class="weather-info"></div>
        <div id="humidity" class="weather-info"></div>
        <div id="wind" class="weather-info"></div>
        <div id="pressure" class="weather-info"></div>
        <div id="uv" class="weather-info"></div>
      </div>
    </div>

    <div class="section">
      <div class="card days">
        <div class="title">7 Days Forecast:</div>
        <div id="forecastDays" class="forecast"></div>
      </div>
      <div class="card Hourly">
        <div class="title">Hourly Forecast:</div>
        <div id="forecastHours" class="forecast"></div>
      </div>
    </div>
  </div>

  <script>
    let currentWeatherURL = "https://api.openweathermap.org/data/2.5/weather?units=metric&q=";
    let forecastWeatherURL = "https://api.openweathermap.org/data/2.5/forecast?units=metric&q=";
    let apiKey = "8e9b8ae1b4e404c6fa759657ff494dec";

    document.getElementById("getWeatherBtn").addEventListener("click", () => {
      let city = document.getElementById("cityInput").value.trim();
      if (city !== "") {
        getWeather(city);
      }
    });

    async function getWeather(city) {
      try {
        let res = await fetch(currentWeatherURL + city + `&appid=${apiKey}`);
        let data = await res.json();

        document.getElementById("cityName").textContent = data.name;
        document.getElementById("currentTime").textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        document.getElementById("currentDate").textContent = new Date().toDateString();

        document.getElementById("tempInfo").innerHTML = `${data.main.temp}&deg;C (Feels like: ${data.main.feels_like}&deg;C)`;
        document.getElementById("weatherIcon").innerHTML = `${getWeatherEmoji(data.weather[0].main)} ${data.weather[0].main}`;
        document.getElementById("sunrise").textContent = `ğŸŒ… Sunrise: ${formatTime(data.sys.sunrise)}`;
        document.getElementById("sunset").textContent = `ğŸŒ‡ Sunset: ${formatTime(data.sys.sunset)}`;
        document.getElementById("humidity").textContent = `ğŸ’§ Humidity: ${data.main.humidity}%`;
        document.getElementById("wind").textContent = `ğŸŒ¬ Wind: ${data.wind.speed} km/h`;
        document.getElementById("pressure").textContent = `ğŸ”µ Pressure: ${data.main.pressure} hPa`;
        document.getElementById("uv").textContent = `ğŸŒ UV: --`;

        fetchForecast(city);
      } catch (err) {
        alert("City not found. Please try again.");
        console.error(err);
      }
    }

    async function fetchForecast(city) {
      try {
        let res = await fetch(forecastWeatherURL + city + `&appid=${apiKey}`);
        let data = await res.json();

        const daily = document.getElementById("forecastDays");
        daily.innerHTML = "";

        const hourly = document.getElementById("forecastHours");
        hourly.innerHTML = "";

        const usedDays = new Set();
        for (let i = 0; i < data.list.length; i++) {
          let item = data.list[i];
          let date = new Date(item.dt * 1000);

          if (i < 5) {
            hourly.innerHTML += `
              <div class="card">${date.getHours()}:00<br>${getWeatherEmoji(item.weather[0].main)}<br>${item.main.temp}&deg;C<br>${item.wind.speed}km/h</div>`;
          }

          let day = date.toDateString();
          if (!usedDays.has(day) && usedDays.size < 7) {
            usedDays.add(day);
            daily.innerHTML += `
              <div class="card">${getWeatherEmoji(item.weather[0].main)}<br>${item.main.temp}&deg;C<br>${day.slice(0, 3)}, ${date.getDate()} ${date.toLocaleString('default', { month: 'short' })}</div>`;
          }
        }
      } catch (err) {
        console.error(err);
      }
    }

    function getWeatherEmoji(condition) {
      switch (condition.toLowerCase()) {
        case "clear": return "â˜€ï¸";
        case "clouds": return "â˜ï¸";
        case "rain": return "ğŸŒ§";
        case "snow": return "ğŸŒ¨";
        case "thunderstorm": return "â›ˆ";
        case "drizzle": return "ğŸŒ¦";
        case "mist":
        case "fog": return "ğŸŒ«";
        default: return "ğŸŒˆ";
      }
    }

    function formatTime(unix) {
      let date = new Date(unix * 1000);
      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }
  </script>
</body>

</html>
